<div class="kReport kContent kOverrideFAIcons">
  <div class="kReportHeader">
    <span class="kTitle">{{'app.engagement.title' | translate}}</span>
    <app-export-csv [headers]="_csvExportHeaders" [totalCount]="_totalCount" [reportInputFilter]="_filter"
                    [reportType]="_reportType"
                    [dimension]="_selectedMetrics" [reportText]="'app.common.noMsg' | translate"
                    [reportTitle]="'app.bandwidth.usersStorage' | translate"></app-export-csv>
    <div class="kFilter kOverrideFAIcons">
      <div class="kDropDown" (click)="_refineFilterOpened = !_refineFilterOpened">
        <span>Filter</span>
        <i *ngIf="!_refineFilterOpened" class="kIcondropdown_arrow_bottom"></i>
        <i *ngIf="_refineFilterOpened" class="kIcondropdown_arrow_top"></i>
      </div>
    </div>
    <app-date-filter #dateFilter [dateRange]="_dateRange" [selectedTimeUnit]="_timeUnit"
                     (filterChange)="_onDateFilterChange($event)"></app-date-filter>
  </div>

  <div class="kReportContainer kTagsContainer" *ngIf="_tags.length">
    <kTags title=""
           labelField="label"
           tooltipField="tooltip"
           [data]="_tags"
           [clearAllLabel]="'app.common.clearAll' | translate"
           (onTagRemove)="refineFilter.removeFilter($event)"
           (onRemoveAll)="refineFilter.removeAll()">
    </kTags>
  </div>

  <div class="kReportContainer" [class.kHidden]="!_refineFilterOpened">
    <app-refine-filter #refineFilter
                       [opened]="_refineFilterOpened"
                       [selectedFilters]="_selectedRefineFilters"
                       (filterChange)="_onRefineFilterChange($event)"
                       (filterTagsChange)="_onFilterTagsChange($event)"></app-refine-filter>
  </div>

  <div class="kReportContainer">
    <app-engagement-highlights [dateFilterComponent]="dateFilter"
                               [dateFilter]="_dateFilter"
                               [refineFilter]="_refineFilter"></app-engagement-highlights>
  </div>

  <div class="kReportContainer">
    <app-engagement-top-videos [dateFilter]="_dateFilter"
                               [refineFilter]="_refineFilter"></app-engagement-top-videos>
  </div>

  <div class="kReportContainer">
    <app-engagement-duration [dateFilter]="_dateFilter"
                             [refineFilter]="_refineFilter"></app-engagement-duration>
  </div>

  <div class="kReportContainer">
    <div class="kSmallReportContainer">
      <app-engagement-impressions [dateFilter]="_dateFilter"
                                  [refineFilter]="_refineFilter"></app-engagement-impressions>
    </div>
    <div class="kSmallReportContainer">
      <app-engagement-users [dateFilter]="_dateFilter"
                            [refineFilter]="_refineFilter"></app-engagement-users>
    </div>
  </div>
</div>


