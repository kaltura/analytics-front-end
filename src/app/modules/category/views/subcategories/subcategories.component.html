<div data-aid="report-subcategories" class="kReport kContent kOverrideFAIcons">
  <k-area-blocker [message]="_blockerMessage" [showLoader]="_isBusy">
    <div class="kReportContent">
      <div class="kFilters">
        <span class="kTitle">{{'app.category.subcategories' | translate}}</span>
      </div>
      <div class="kTable">
        <p-table dataKey="object_id"
                 [sortField]="'count_plays'"
                 [value]="_tableData"
                 [customSort]="true"
                 [defaultSortOrder]="-1"
                 [sortOrder]="-1"
                 (sortFunction)="_onSortChanged($event)">
          <ng-template pTemplate="header">
            <tr>
              <th [ngStyle]="{'width': '52px'}"></th>
              <th>{{'app.entry.name' | translate}}</th>
              <th [pSortableColumn]="_isCompareMode ? null : 'count_plays'">
                {{'app.entry.count_plays' | translate}}
                <p-sortIcon [field]="'count_plays'" *ngIf="!_isCompareMode"></p-sortIcon>
              </th>
              <!--th *ngFor="let col of _columns" [pSortableColumn]="_isCompareMode || col === 'entry_name' ? null : col">
                {{'app.entry.' + col | translate}}
                <p-sortIcon [field]="col" *ngIf="!_isCompareMode && col !== 'name'"></p-sortIcon>
              </th-->

            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-data>
            <tr>
              <td>
                <i class="kIconfolder_large"></i>
              </td>
              <td class="kHighlight">
                <a class="kEntryLink kTableColumn"
                   [kTooltip]="data['name']"
                   [showOnEllipsis]="true">{{data['name']}}</a>
              </td>
              <td>
                <span *ngIf="_isCompareMode" class="kTrend">
                  <span [kTooltip]="data['count_plays'].tooltip" [escape]="false" [maxWidth]="500">
                    <app-trend-value [value]="data['count_plays'].value"
                                     [units]="data['count_plays'].units"
                                     [trend]="data['count_plays'].trend"></app-trend-value>
                  </span>
                </span>
                <span *ngIf="!_isCompareMode">{{data['count_plays']}}</span>
              </td>

              <!--td *ngFor="let col of _columns; let i = index" [class.kHighlight]="i===0">
            <span *ngIf="_isCompareMode && data[col]?.value && col !== 'entry_name'"
                  class="kTrend">
              <span [kTooltip]="data[col].tooltip" [escape]="false" [maxWidth]="500">
                <app-trend-value [value]="data[col].value"
                                 [units]="data[col].units"
                                 [trend]="data[col].trend"></app-trend-value>
              </span>
            </span>
                <ng-container *ngIf="!_isCompareMode || col === 'entry_name'">
                  <span
                    *ngIf="col !== 'entry_name' && col !== 'total_completion_rate' && (col !== 'avg_completion_rate' || (col == 'avg_completion_rate' && userDrilldown))">{{data[col]}}</span>
                  <span class="kEntryLink kTableColumn"
                        *ngIf="col === 'entry_name' && (userDrilldown || !_viewConfig.entryDrilldown)"
                        [kTooltip]="data[col]"
                        [showOnEllipsis]="true"
                  >{{data[col]}}</span>
                  <a class="kEntryLink kTableColumn"
                     *ngIf="col === 'entry_name' && !userDrilldown && _viewConfig.entryDrilldown"
                     [kTooltip]="data[col]"
                     [showOnEllipsis]="true"
                     (click)="_drillDown(data)">{{data[col]}}</a>
                  <app-bullet
                    *ngIf="(col === 'avg_completion_rate' && !userDrilldown) || col === 'total_completion_rate'"
                    [value]="data[col]" [animate]="false" [colorScheme]="'dropoff'"></app-bullet>
                </ng-container>
              </td-->
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <div class="emptymessage">
              <div class="kEmptyMessage" *ngIf="!_firstTimeLoading">{{'app.common.noResults' | translate}}</div>
              <div class="kEmptyMessage" *ngIf="_firstTimeLoading">&nbsp;</div>
            </div>
          </ng-template>
        </p-table>

        <p-paginator [rows]="_pager.pageSize"
                     [first]="(_pager.pageIndex -1) * _pager.pageSize"
                     [totalRecords]="totalCount"
                     (onPageChange)="_onPaginationChanged($event)"></p-paginator>
      </div>
    </div>
  </k-area-blocker>
</div>
